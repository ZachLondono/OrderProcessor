@using ApplicationCore.Features.Orders.Shared.Domain.Products;
@using ApplicationCore.Features.Orders.Shared.Domain.ValueObjects;
@using ApplicationCore.Features.Orders.Shared.Domain;
@using ApplicationCore.Shared.Components
@using ApplicationCore.Infrastructure;
@using ApplicationCore.Features.Orders.Shared;
@using ApplicationCore.Features.Orders.Shared.Domain.Enums;
@using static ApplicationCore.Features.Orders.Details.OrderDetails;
@using ApplicationCore.Infrastructure.Bus;
@inject IBus Bus

<div class="overflow-x-auto rounded-md">
    <table class="table-auto">
        <thead class="border-b border-slate-300">
            <tr>
                <th class="p-5">#</th>
                <th class="p-5">Qty</th>
                <th class="p-5">Height</th>
                <th class="p-5">Width</th>
                <th class="p-5">Depth</th>
                <th class="p-5">F/B Adj.</th>
                <th class="p-5">Front Material</th>
                <th class="p-5">Side Material</th>
                <th class="p-5">Back Material</th>
                <th class="p-5">Bottom Material</th>
                <th class="p-5">Machine for UM</th>
                <th class="p-5">Unit $</th>
                <th class="p-5">Ext. $</th>
            </tr>
        </thead>
        <tbody>
            @{
                foreach (var row in DrawerBoxes) {
                    <tr>
                        <td class="whitespace-nowrap p-5 border-b text-center">@row.ProductNumber</td>
                        <td class="whitespace-nowrap p-5 border-b text-center">@row.Qty</td>
                        @if (UseInches) {
                            <td class="whitespace-nowrap p-5 border-b text-center">@((MarkupString)row.Height.GetFormatedFraction())"</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@((MarkupString)row.Width.GetFormatedFraction())"</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@((MarkupString)row.Depth.GetFormatedFraction())"</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@((MarkupString)row.FrontBackHeightAdjustment.GetFormatedFraction())</td>
                        } else {
                            <td class="whitespace-nowrap p-5 border-b text-center">@row.Height.AsMillimeters().ToString("0.00")</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@row.Width.AsMillimeters().ToString("0.00")</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@row.Depth.AsMillimeters().ToString("0.00")</td>
                            <td class="whitespace-nowrap p-5 border-b text-center">@row.FrontBackHeightAdjustment.AsMillimeters().ToString("0.00")</td>
                        }
                        <td class="whitespace-nowrap p-5 border-b">@((MarkupString)MaterialString(row.FrontMaterial, UseInches))</td>
                        <td class="whitespace-nowrap p-5 border-b">@((MarkupString)MaterialString(row.SideMaterial,UseInches))</td>
                        <td class="whitespace-nowrap p-5 border-b">@((MarkupString)MaterialString(row.BackMaterial,UseInches))</td>
                        <td class="whitespace-nowrap p-5 border-b">@((MarkupString)MaterialString(row.BottomMaterial,UseInches))</td>
                        <td class="whitespace-nowrap p-5 border-b text-center">@(row.MachineThicknessForUMSlides ? "Y" : "N")</td>
                        <td class="whitespace-nowrap p-5 border-b text-center">$@row.UnitPrice.ToString("0.00")</td>
                        <td class="whitespace-nowrap p-5 border-b text-center">$@((row.UnitPrice * row.Qty).ToString("0.00"))</td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>

@code {

    [Parameter]
    public IEnumerable<DoweledDrawerBoxProduct> DrawerBoxes { get; set; } = Enumerable.Empty<DoweledDrawerBoxProduct>();

    [Parameter]
    public bool UseInches { get; set; } = false;

    public string MaterialString(DoweledDrawerBoxMaterial material, bool useInches) {

        if (useInches) {
            return $"{material.Name}\\{material.Thickness.GetFormatedFraction()}\\Grained:{(material.IsGrained ? "Y" : "N")}";
        }
        return $"{material.Name}\\{material.Thickness.AsMillimeters().ToString("0.00")}\\Grained:{(material.IsGrained ? "Y" : "N")}";

    }

}
